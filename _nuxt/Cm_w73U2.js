import{b8 as H}from"./bViua8A2.js";var L={},T={},F={},O={},x;function z(){if(x)return O;x=1,Object.defineProperty(O,"__esModule",{value:!0}),O.assertNever=t,O.pick=a,O.isObject=s;function t(u){throw new Error(`Unexpected value should never occur: ${u}`)}function a(u,d){const m=d.map(y=>[y,u?.[y]]);return Object.fromEntries(m)}function s(u){return typeof u=="object"&&u!==null}return O}var V;function X(){if(V)return F;V=1,Object.defineProperty(F,"__esModule",{value:!0}),F.LogLevel=void 0,F.makeConsoleLogger=s,F.logLevelSeverity=u;const t=z();var a;(function(d){d.DEBUG="debug",d.INFO="info",d.WARN="warn",d.ERROR="error"})(a||(F.LogLevel=a={}));function s(d){return(m,y,P)=>{console[m](`${d} ${m}:`,y,P)}}function u(d){switch(d){case a.DEBUG:return 20;case a.INFO:return 40;case a.WARN:return 60;case a.ERROR:return 80;default:return(0,t.assertNever)(d)}}return F}var g={},W;function Y(){if(W)return g;W=1,Object.defineProperty(g,"__esModule",{value:!0}),g.APIResponseError=g.UnknownHTTPResponseError=g.RequestTimeoutError=g.ClientErrorCode=g.APIErrorCode=void 0,g.isNotionClientError=d,g.isHTTPResponseError=k,g.buildRequestError=o;const t=z();var a;(function(l){l.Unauthorized="unauthorized",l.RestrictedResource="restricted_resource",l.ObjectNotFound="object_not_found",l.RateLimited="rate_limited",l.InvalidJSON="invalid_json",l.InvalidRequestURL="invalid_request_url",l.InvalidRequest="invalid_request",l.ValidationError="validation_error",l.ConflictError="conflict_error",l.InternalServerError="internal_server_error",l.ServiceUnavailable="service_unavailable"})(a||(g.APIErrorCode=a={}));var s;(function(l){l.RequestTimeout="notionhq_client_request_timeout",l.ResponseError="notionhq_client_response_error"})(s||(g.ClientErrorCode=s={}));class u extends Error{}function d(l){return(0,t.isObject)(l)&&l instanceof u}function m(l,c){return d(l)&&l.code in c}class y extends u{constructor(c="Request to Notion API has timed out"){super(c),this.code=s.RequestTimeout,this.name="RequestTimeoutError"}static isRequestTimeoutError(c){return m(c,{[s.RequestTimeout]:!0})}static rejectAfterTimeout(c,n){return new Promise((f,p)=>{const _=setTimeout(()=>{p(new y)},n);c.then(f).catch(p).then(()=>clearTimeout(_))})}}g.RequestTimeoutError=y;class P extends u{constructor(c){super(c.message),this.name="HTTPResponseError";const{code:n,status:f,headers:p,rawBodyText:_}=c;this.code=n,this.status=f,this.headers=p,this.body=_}}const v={[s.ResponseError]:!0,[a.Unauthorized]:!0,[a.RestrictedResource]:!0,[a.ObjectNotFound]:!0,[a.RateLimited]:!0,[a.InvalidJSON]:!0,[a.InvalidRequestURL]:!0,[a.InvalidRequest]:!0,[a.ValidationError]:!0,[a.ConflictError]:!0,[a.InternalServerError]:!0,[a.ServiceUnavailable]:!0};function k(l){return!!m(l,v)}class w extends P{constructor(c){var n;super({...c,code:s.ResponseError,message:(n=c.message)!==null&&n!==void 0?n:`Request to Notion API failed with status: ${c.status}`}),this.name="UnknownHTTPResponseError"}static isUnknownHTTPResponseError(c){return m(c,{[s.ResponseError]:!0})}}g.UnknownHTTPResponseError=w;const h={[a.Unauthorized]:!0,[a.RestrictedResource]:!0,[a.ObjectNotFound]:!0,[a.RateLimited]:!0,[a.InvalidJSON]:!0,[a.InvalidRequestURL]:!0,[a.InvalidRequest]:!0,[a.ValidationError]:!0,[a.ConflictError]:!0,[a.InternalServerError]:!0,[a.ServiceUnavailable]:!0};class C extends P{constructor(){super(...arguments),this.name="APIResponseError"}static isAPIResponseError(c){return m(c,h)}}g.APIResponseError=C;function o(l,c){const n=r(c);return n!==void 0?new C({code:n.code,message:n.message,headers:l.headers,status:l.status,rawBodyText:c}):new w({message:void 0,headers:l.headers,status:l.status,rawBodyText:c})}function r(l){if(typeof l!="string")return;let c;try{c=JSON.parse(l)}catch{return}if(!(!(0,t.isObject)(c)||typeof c.message!="string"||!I(c.code)))return{...c,code:c.code,message:c.message}}function I(l){return typeof l=="string"&&l in h}return g}var i={},J;function te(){return J||(J=1,Object.defineProperty(i,"__esModule",{value:!0}),i.oauthIntrospect=i.oauthRevoke=i.oauthToken=i.getFileUpload=i.completeFileUpload=i.sendFileUpload=i.listFileUploads=i.createFileUpload=i.getComment=i.listComments=i.createComment=i.search=i.createDatabase=i.listDatabases=i.queryDatabase=i.updateDatabase=i.getDatabase=i.appendBlockChildren=i.listBlockChildren=i.deleteBlock=i.updateBlock=i.getBlock=i.getPageProperty=i.updatePage=i.getPage=i.createPage=i.listUsers=i.getUser=i.getSelf=void 0,i.getSelf={method:"get",pathParams:[],queryParams:[],bodyParams:[],path:()=>"users/me"},i.getUser={method:"get",pathParams:["user_id"],queryParams:[],bodyParams:[],path:t=>`users/${t.user_id}`},i.listUsers={method:"get",pathParams:[],queryParams:["start_cursor","page_size"],bodyParams:[],path:()=>"users"},i.createPage={method:"post",pathParams:[],queryParams:[],bodyParams:["parent","properties","icon","cover","content","children"],path:()=>"pages"},i.getPage={method:"get",pathParams:["page_id"],queryParams:["filter_properties"],bodyParams:[],path:t=>`pages/${t.page_id}`},i.updatePage={method:"patch",pathParams:["page_id"],queryParams:[],bodyParams:["properties","icon","cover","archived","in_trash"],path:t=>`pages/${t.page_id}`},i.getPageProperty={method:"get",pathParams:["page_id","property_id"],queryParams:["start_cursor","page_size"],bodyParams:[],path:t=>`pages/${t.page_id}/properties/${t.property_id}`},i.getBlock={method:"get",pathParams:["block_id"],queryParams:[],bodyParams:[],path:t=>`blocks/${t.block_id}`},i.updateBlock={method:"patch",pathParams:["block_id"],queryParams:[],bodyParams:["embed","type","archived","in_trash","bookmark","image","video","pdf","file","audio","code","equation","divider","breadcrumb","table_of_contents","link_to_page","table_row","heading_1","heading_2","heading_3","paragraph","bulleted_list_item","numbered_list_item","quote","to_do","toggle","template","callout","synced_block","table","column"],path:t=>`blocks/${t.block_id}`},i.deleteBlock={method:"delete",pathParams:["block_id"],queryParams:[],bodyParams:[],path:t=>`blocks/${t.block_id}`},i.listBlockChildren={method:"get",pathParams:["block_id"],queryParams:["start_cursor","page_size"],bodyParams:[],path:t=>`blocks/${t.block_id}/children`},i.appendBlockChildren={method:"patch",pathParams:["block_id"],queryParams:[],bodyParams:["children","after"],path:t=>`blocks/${t.block_id}/children`},i.getDatabase={method:"get",pathParams:["database_id"],queryParams:[],bodyParams:[],path:t=>`databases/${t.database_id}`},i.updateDatabase={method:"patch",pathParams:["database_id"],queryParams:[],bodyParams:["title","description","icon","cover","properties","is_inline","archived","in_trash"],path:t=>`databases/${t.database_id}`},i.queryDatabase={method:"post",pathParams:["database_id"],queryParams:["filter_properties"],bodyParams:["sorts","filter","start_cursor","page_size","archived","in_trash"],path:t=>`databases/${t.database_id}/query`},i.listDatabases={method:"get",pathParams:[],queryParams:["start_cursor","page_size"],bodyParams:[],path:()=>"databases"},i.createDatabase={method:"post",pathParams:[],queryParams:[],bodyParams:["parent","properties","icon","cover","title","description","is_inline"],path:()=>"databases"},i.search={method:"post",pathParams:[],queryParams:[],bodyParams:["sort","query","start_cursor","page_size","filter"],path:()=>"search"},i.createComment={method:"post",pathParams:[],queryParams:[],bodyParams:["rich_text","attachments","display_name","parent","discussion_id"],path:()=>"comments"},i.listComments={method:"get",pathParams:[],queryParams:["block_id","start_cursor","page_size"],bodyParams:[],path:()=>"comments"},i.getComment={method:"get",pathParams:["comment_id"],queryParams:[],bodyParams:[],path:t=>`comments/${t.comment_id}`},i.createFileUpload={method:"post",pathParams:[],queryParams:[],bodyParams:["mode","filename","content_type","number_of_parts","external_url"],path:()=>"file_uploads"},i.listFileUploads={method:"get",pathParams:[],queryParams:["status","start_cursor","page_size"],bodyParams:[],path:()=>"file_uploads"},i.sendFileUpload={method:"post",pathParams:["file_upload_id"],queryParams:[],bodyParams:[],formDataParams:["file","part_number"],path:t=>`file_uploads/${t.file_upload_id}/send`},i.completeFileUpload={method:"post",pathParams:["file_upload_id"],queryParams:[],bodyParams:[],path:t=>`file_uploads/${t.file_upload_id}/complete`},i.getFileUpload={method:"get",pathParams:["file_upload_id"],queryParams:[],bodyParams:[],path:t=>`file_uploads/${t.file_upload_id}`},i.oauthToken={method:"post",pathParams:[],queryParams:[],bodyParams:["grant_type","code","redirect_uri","external_account","refresh_token"],path:()=>"oauth/token"},i.oauthRevoke={method:"post",pathParams:[],queryParams:[],bodyParams:["token"],path:()=>"oauth/revoke"},i.oauthIntrospect={method:"post",pathParams:[],queryParams:[],bodyParams:["token"],path:()=>"oauth/introspect"}),i}const re="@notionhq/client",ae="4.0.2",oe={name:re,version:ae};var G;function ie(){if(G)return T;G=1;var t=T&&T.__classPrivateFieldSet||function(c,n,f,p,_){if(p==="m")throw new TypeError("Private method is not writable");if(p==="a"&&!_)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?c!==n||!_:!n.has(c))throw new TypeError("Cannot write private member to an object whose class did not declare it");return p==="a"?_.call(c,f):_?_.value=f:n.set(c,f),f},a=T&&T.__classPrivateFieldGet||function(c,n,f,p){if(f==="a"&&!p)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?c!==n||!p:!n.has(c))throw new TypeError("Cannot read private member from an object whose class did not declare it");return f==="m"?p:f==="a"?p.call(c):p?p.value:n.get(c)},s,u,d,m,y,P,v,k,w;Object.defineProperty(T,"__esModule",{value:!0});const h=X(),C=Y(),o=z(),r=te(),I=oe;let l=class Z{constructor(n){var f,p,_,$,j,U;s.set(this,void 0),u.set(this,void 0),d.set(this,void 0),m.set(this,void 0),y.set(this,void 0),P.set(this,void 0),v.set(this,void 0),k.set(this,void 0),w.set(this,void 0),this.blocks={retrieve:e=>this.request({path:r.getBlock.path(e),method:r.getBlock.method,query:(0,o.pick)(e,r.getBlock.queryParams),body:(0,o.pick)(e,r.getBlock.bodyParams),auth:e?.auth}),update:e=>this.request({path:r.updateBlock.path(e),method:r.updateBlock.method,query:(0,o.pick)(e,r.updateBlock.queryParams),body:(0,o.pick)(e,r.updateBlock.bodyParams),auth:e?.auth}),delete:e=>this.request({path:r.deleteBlock.path(e),method:r.deleteBlock.method,query:(0,o.pick)(e,r.deleteBlock.queryParams),body:(0,o.pick)(e,r.deleteBlock.bodyParams),auth:e?.auth}),children:{append:e=>this.request({path:r.appendBlockChildren.path(e),method:r.appendBlockChildren.method,query:(0,o.pick)(e,r.appendBlockChildren.queryParams),body:(0,o.pick)(e,r.appendBlockChildren.bodyParams),auth:e?.auth}),list:e=>this.request({path:r.listBlockChildren.path(e),method:r.listBlockChildren.method,query:(0,o.pick)(e,r.listBlockChildren.queryParams),body:(0,o.pick)(e,r.listBlockChildren.bodyParams),auth:e?.auth})}},this.databases={list:e=>this.request({path:r.listDatabases.path(),method:r.listDatabases.method,query:(0,o.pick)(e,r.listDatabases.queryParams),body:(0,o.pick)(e,r.listDatabases.bodyParams),auth:e?.auth}),retrieve:e=>this.request({path:r.getDatabase.path(e),method:r.getDatabase.method,query:(0,o.pick)(e,r.getDatabase.queryParams),body:(0,o.pick)(e,r.getDatabase.bodyParams),auth:e?.auth}),query:e=>this.request({path:r.queryDatabase.path(e),method:r.queryDatabase.method,query:(0,o.pick)(e,r.queryDatabase.queryParams),body:(0,o.pick)(e,r.queryDatabase.bodyParams),auth:e?.auth}),create:e=>this.request({path:r.createDatabase.path(),method:r.createDatabase.method,query:(0,o.pick)(e,r.createDatabase.queryParams),body:(0,o.pick)(e,r.createDatabase.bodyParams),auth:e?.auth}),update:e=>this.request({path:r.updateDatabase.path(e),method:r.updateDatabase.method,query:(0,o.pick)(e,r.updateDatabase.queryParams),body:(0,o.pick)(e,r.updateDatabase.bodyParams),auth:e?.auth})},this.pages={create:e=>this.request({path:r.createPage.path(),method:r.createPage.method,query:(0,o.pick)(e,r.createPage.queryParams),body:(0,o.pick)(e,r.createPage.bodyParams),auth:e?.auth}),retrieve:e=>this.request({path:r.getPage.path(e),method:r.getPage.method,query:(0,o.pick)(e,r.getPage.queryParams),body:(0,o.pick)(e,r.getPage.bodyParams),auth:e?.auth}),update:e=>this.request({path:r.updatePage.path(e),method:r.updatePage.method,query:(0,o.pick)(e,r.updatePage.queryParams),body:(0,o.pick)(e,r.updatePage.bodyParams),auth:e?.auth}),properties:{retrieve:e=>this.request({path:r.getPageProperty.path(e),method:r.getPageProperty.method,query:(0,o.pick)(e,r.getPageProperty.queryParams),body:(0,o.pick)(e,r.getPageProperty.bodyParams),auth:e?.auth})}},this.users={retrieve:e=>this.request({path:r.getUser.path(e),method:r.getUser.method,query:(0,o.pick)(e,r.getUser.queryParams),body:(0,o.pick)(e,r.getUser.bodyParams),auth:e?.auth}),list:e=>this.request({path:r.listUsers.path(),method:r.listUsers.method,query:(0,o.pick)(e,r.listUsers.queryParams),body:(0,o.pick)(e,r.listUsers.bodyParams),auth:e?.auth}),me:e=>this.request({path:r.getSelf.path(),method:r.getSelf.method,query:(0,o.pick)(e,r.getSelf.queryParams),body:(0,o.pick)(e,r.getSelf.bodyParams),auth:e?.auth})},this.comments={create:e=>this.request({path:r.createComment.path(),method:r.createComment.method,query:(0,o.pick)(e,r.createComment.queryParams),body:(0,o.pick)(e,r.createComment.bodyParams),auth:e?.auth}),list:e=>this.request({path:r.listComments.path(),method:r.listComments.method,query:(0,o.pick)(e,r.listComments.queryParams),body:(0,o.pick)(e,r.listComments.bodyParams),auth:e?.auth}),retrieve:e=>this.request({path:r.getComment.path(e),method:r.getComment.method,query:(0,o.pick)(e,r.getComment.queryParams),body:(0,o.pick)(e,r.getComment.bodyParams),auth:e?.auth})},this.fileUploads={create:e=>this.request({path:r.createFileUpload.path(),method:r.createFileUpload.method,query:(0,o.pick)(e,r.createFileUpload.queryParams),body:(0,o.pick)(e,r.createFileUpload.bodyParams),auth:e?.auth}),retrieve:e=>this.request({path:r.getFileUpload.path(e),method:r.getFileUpload.method,query:(0,o.pick)(e,r.getFileUpload.queryParams),auth:e?.auth}),list:e=>this.request({path:r.listFileUploads.path(),method:r.listFileUploads.method,query:(0,o.pick)(e,r.listFileUploads.queryParams),auth:e?.auth}),send:e=>this.request({path:r.sendFileUpload.path(e),method:r.sendFileUpload.method,query:(0,o.pick)(e,r.sendFileUpload.queryParams),formDataParams:(0,o.pick)(e,r.sendFileUpload.formDataParams),auth:e?.auth}),complete:e=>this.request({path:r.completeFileUpload.path(e),method:r.completeFileUpload.method,query:(0,o.pick)(e,r.completeFileUpload.queryParams),auth:e?.auth})},this.search=e=>this.request({path:r.search.path(),method:r.search.method,query:(0,o.pick)(e,r.search.queryParams),body:(0,o.pick)(e,r.search.bodyParams),auth:e?.auth}),this.oauth={token:e=>this.request({path:r.oauthToken.path(),method:r.oauthToken.method,query:(0,o.pick)(e,r.oauthToken.queryParams),body:(0,o.pick)(e,r.oauthToken.bodyParams),auth:{client_id:e.client_id,client_secret:e.client_secret}}),introspect:e=>this.request({path:r.oauthIntrospect.path(),method:r.oauthIntrospect.method,query:(0,o.pick)(e,r.oauthIntrospect.queryParams),body:(0,o.pick)(e,r.oauthIntrospect.bodyParams),auth:{client_id:e.client_id,client_secret:e.client_secret}}),revoke:e=>this.request({path:r.oauthRevoke.path(),method:r.oauthRevoke.method,query:(0,o.pick)(e,r.oauthRevoke.queryParams),body:(0,o.pick)(e,r.oauthRevoke.bodyParams),auth:{client_id:e.client_id,client_secret:e.client_secret}})},t(this,s,n?.auth,"f"),t(this,u,(f=n?.logLevel)!==null&&f!==void 0?f:h.LogLevel.WARN,"f"),t(this,d,(p=n?.logger)!==null&&p!==void 0?p:(0,h.makeConsoleLogger)(I.name),"f"),t(this,m,`${(_=n?.baseUrl)!==null&&_!==void 0?_:"https://api.notion.com"}/v1/`,"f"),t(this,y,($=n?.timeoutMs)!==null&&$!==void 0?$:6e4,"f"),t(this,P,(j=n?.notionVersion)!==null&&j!==void 0?j:Z.defaultNotionVersion,"f"),t(this,v,(U=n?.fetch)!==null&&U!==void 0?U:fetch,"f"),t(this,k,n?.agent,"f"),t(this,w,`notionhq-client/${I.version}`,"f")}async request(n){const{path:f,method:p,query:_,body:$,formDataParams:j,auth:U}=n;this.log(h.LogLevel.INFO,"request start",{method:p,path:f});const e=!$||Object.entries($).length===0?void 0:JSON.stringify($),B=new URL(`${a(this,m,"f")}${f}`);if(_){for(const[b,q]of Object.entries(_))if(q!==void 0)if(Array.isArray(q))for(const A of q)B.searchParams.append(b,decodeURIComponent(A));else B.searchParams.append(b,String(q))}let D;if(typeof U=="object"){const b=`${U.client_id}:${U.client_secret}`;D={authorization:`Basic ${Buffer.from(b).toString("base64")}`}}else D=this.authAsHeaders(U);const S={...n.headers,...D,"Notion-Version":a(this,P,"f"),"user-agent":a(this,w,"f")};e!==void 0&&(S["content-type"]="application/json");let N;if(j){delete S["content-type"],N=new FormData;for(const[b,q]of Object.entries(j))typeof q=="string"?N.append(b,q):typeof q=="object"&&N.append(b,typeof q.data=="object"?q.data:new Blob([q.data]),q.filename)}try{const b=await C.RequestTimeoutError.rejectAfterTimeout(a(this,v,"f").call(this,B.toString(),{method:p.toUpperCase(),headers:S,body:e??N,agent:a(this,k,"f")}),a(this,y,"f")),q=await b.text();if(!b.ok)throw(0,C.buildRequestError)(b,q);const A=JSON.parse(q);return this.log(h.LogLevel.INFO,"request success",{method:p,path:f}),A}catch(b){throw(0,C.isNotionClientError)(b)&&(this.log(h.LogLevel.WARN,"request fail",{code:b.code,message:b.message}),(0,C.isHTTPResponseError)(b)&&this.log(h.LogLevel.DEBUG,"failed response body",{body:b.body})),b}}log(n,f,p){(0,h.logLevelSeverity)(n)>=(0,h.logLevelSeverity)(a(this,u,"f"))&&a(this,d,"f").call(this,n,f,p)}authAsHeaders(n){const f={},p=n??a(this,s,"f");return p!==void 0&&(f.authorization=`Bearer ${p}`),f}};return s=new WeakMap,u=new WeakMap,d=new WeakMap,m=new WeakMap,y=new WeakMap,P=new WeakMap,v=new WeakMap,k=new WeakMap,w=new WeakMap,l.defaultNotionVersion="2022-06-28",T.default=l,T}var R={},K;function ne(){if(K)return R;K=1,Object.defineProperty(R,"__esModule",{value:!0}),R.iteratePaginatedAPI=t,R.collectPaginatedAPI=a,R.isFullBlock=s,R.isFullPage=u,R.isFullDatabase=d,R.isFullPageOrDatabase=m,R.isFullUser=y,R.isFullComment=P,R.isTextRichTextItemResponse=v,R.isEquationRichTextItemResponse=k,R.isMentionRichTextItemResponse=w;async function*t(h,C){let o=C.start_cursor;do{const r=await h({...C,start_cursor:o});yield*r.results,o=r.next_cursor}while(o)}async function a(h,C){const o=[];for await(const r of t(h,C))o.push(r);return o}function s(h){return h.object==="block"&&"type"in h}function u(h){return h.object==="page"&&"url"in h}function d(h){return h.object==="database"&&"title"in h}function m(h){return h.object==="database"?d(h):u(h)}function y(h){return"type"in h}function P(h){return"created_by"in h}function v(h){return h.type==="text"}function k(h){return h.type==="equation"}function w(h){return h.type==="mention"}return R}var Q;function se(){return Q||(Q=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isFullPageOrDatabase=t.isFullComment=t.isFullUser=t.isFullPage=t.isFullDatabase=t.isFullBlock=t.iteratePaginatedAPI=t.collectPaginatedAPI=t.isNotionClientError=t.RequestTimeoutError=t.UnknownHTTPResponseError=t.APIResponseError=t.ClientErrorCode=t.APIErrorCode=t.LogLevel=t.Client=void 0;var a=ie();Object.defineProperty(t,"Client",{enumerable:!0,get:function(){return a.default}});var s=X();Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return s.LogLevel}});var u=Y();Object.defineProperty(t,"APIErrorCode",{enumerable:!0,get:function(){return u.APIErrorCode}}),Object.defineProperty(t,"ClientErrorCode",{enumerable:!0,get:function(){return u.ClientErrorCode}}),Object.defineProperty(t,"APIResponseError",{enumerable:!0,get:function(){return u.APIResponseError}}),Object.defineProperty(t,"UnknownHTTPResponseError",{enumerable:!0,get:function(){return u.UnknownHTTPResponseError}}),Object.defineProperty(t,"RequestTimeoutError",{enumerable:!0,get:function(){return u.RequestTimeoutError}}),Object.defineProperty(t,"isNotionClientError",{enumerable:!0,get:function(){return u.isNotionClientError}});var d=ne();Object.defineProperty(t,"collectPaginatedAPI",{enumerable:!0,get:function(){return d.collectPaginatedAPI}}),Object.defineProperty(t,"iteratePaginatedAPI",{enumerable:!0,get:function(){return d.iteratePaginatedAPI}}),Object.defineProperty(t,"isFullBlock",{enumerable:!0,get:function(){return d.isFullBlock}}),Object.defineProperty(t,"isFullDatabase",{enumerable:!0,get:function(){return d.isFullDatabase}}),Object.defineProperty(t,"isFullPage",{enumerable:!0,get:function(){return d.isFullPage}}),Object.defineProperty(t,"isFullUser",{enumerable:!0,get:function(){return d.isFullUser}}),Object.defineProperty(t,"isFullComment",{enumerable:!0,get:function(){return d.isFullComment}}),Object.defineProperty(t,"isFullPageOrDatabase",{enumerable:!0,get:function(){return d.isFullPageOrDatabase}})})(L)),L}se();const ue=60*1e3;function M(){{if(typeof window<"u")try{let t=sessionStorage.getItem("notion-posts-cache");return!t&&window.localStorage&&(t=localStorage.getItem("notion-posts-cache")),t?JSON.parse(t):null}catch{return null}return null}}function de(t){const a={data:t,timestamp:Date.now()};if(typeof window<"u")try{sessionStorage.setItem("notion-posts-cache",JSON.stringify(a)),localStorage.setItem("notion-posts-cache",JSON.stringify(a))}catch{}}function le(){const t=M();return t?Date.now()-t.timestamp<ue:!1}function ce(){if(console.log("üßπ Limpiando cache de Notion..."),typeof window<"u")try{sessionStorage.removeItem("notion-posts-cache"),localStorage.removeItem("notion-posts-cache"),console.log("‚úÖ Cache limpiado exitosamente")}catch{console.warn("‚ö†Ô∏è No se pudo limpiar el cache del storage")}}function he(t){const a={};if(t.title?.title?.[0]?.plain_text&&(a.title=t.title.title[0].plain_text),t.description?.rich_text?.[0]?.plain_text&&(a.description=t.description.rich_text[0].plain_text),t.date?.date?.start&&(a.date=t.date.date.start),t.image?.url?a.image=t.image.url:t.image?.files?.[0]?.file?.url&&(a.image=t.image.files[0].file.url),t.minRead?.number&&(a.minRead=t.minRead.number),t.author?.people?.[0]){const s=t.author.people[0];a.author={name:s.name||"Autor desconocido",avatar:s.avatar_url?{src:s.avatar_url,alt:s.name||"Avatar del autor"}:void 0}}return a}async function me(t){try{const a=H(),s="https://notion-proxy.adrigarcia-unahur.workers.dev",u=`/blocks/${t}/children`,d=await fetch(`${s}${u}`,{method:"GET",headers:{Authorization:`Bearer ${a.public.notionToken}`,"Notion-Version":"2022-06-28"}});if(!d.ok)throw new Error(`Error obteniendo contenido: ${d.status}`);const m=await d.json();let y="";for(const P of m.results||[])y+=await ee(P);return y||"Contenido no disponible"}catch(a){return console.error("Error obteniendo contenido de Notion desde cliente:",a),"Contenido no disponible"}}async function ee(t){const a=H(),s="https://notion-proxy.adrigarcia-unahur.workers.dev",u=async d=>{try{if(t.has_children){const m=await fetch(`${s}/blocks/${d}/children`,{method:"GET",headers:{Authorization:`Bearer ${a.public.notionToken}`,"Notion-Version":"2022-06-28"}});if(!m.ok)return console.error(`Error obteniendo bloques hijos: ${m.status}`),"";const y=await m.json();let P="";for(const v of y.results||[])P+=await ee(v);return P}return""}catch(m){return console.error("Error procesando bloques hijos en cliente:",m),""}};switch(t.type){case"paragraph":const d=await u(t.id);return`${E(t.paragraph.rich_text)}
${d}
`;case"heading_1":return`# ${E(t.heading_1.rich_text)}

`;case"heading_2":return`## ${E(t.heading_2.rich_text)}

`;case"heading_3":return`### ${E(t.heading_3.rich_text)}

`;case"bulleted_list_item":const m=await u(t.id);return`- ${E(t.bulleted_list_item.rich_text)}
${m}`;case"numbered_list_item":const y=await u(t.id);return`1. ${E(t.numbered_list_item.rich_text)}
${y}`;case"quote":return`> ${E(t.quote.rich_text)}

`;case"code":return`\`\`\`${t.code.language||""}
${E(t.code.rich_text)}
\`\`\`

`;case"callout":const P=t.callout.icon?.emoji||"üí°",v=await u(t.id);return`> ${P} ${E(t.callout.rich_text)}
${v}
`;case"divider":return`---

`;case"image":const k=t.image.file?.url||t.image.external?.url,w=t.image.caption?E(t.image.caption):"";return k?`![${w}](${k})

`:(console.warn("Imagen sin URL encontrada:",t.image),"");case"video":return`[Video](${t.video.file?.url||t.video.external?.url})

`;case"file":const C=t.file.file?.url||t.file.external?.url;return`[${t.file.name||"Archivo"}](${C})

`;case"bookmark":return`[${t.bookmark.url}](${t.bookmark.url})

`;case"embed":return`[Embed](${t.embed.url})

`;case"table":return`${await u(t.id)}
`;case"table_row":return`| ${t.table_row.cells.map($=>E($)).join(" | ")} |
`;case"toggle":const l=await u(t.id);return`<details>
<summary>${E(t.toggle.rich_text)}</summary>

${l}</details>

`;case"to_do":const c=t.to_do.checked?"[x]":"[ ]",n=await u(t.id);return`- ${c} ${E(t.to_do.rich_text)}
${n}`;case"column_list":return`${await u(t.id)}
`;case"column":return`${await u(t.id)}`;case"synced_block":return`${await u(t.id)}`;default:return console.warn(`Tipo de bloque no soportado en cliente: ${t.type}`),""}}function E(t){return!t||!Array.isArray(t)?"":t.map(a=>{let s=a.plain_text||"";if(a.annotations){const{bold:u,italic:d,strikethrough:m,underline:y,code:P}=a.annotations;P?s=`\`${s}\``:(u&&(s=`**${s}**`),d&&(s=`*${s}*`),m&&(s=`~~${s}~~`),y&&(s=`<u>${s}</u>`))}return a.href&&(s=`[${s}](${a.href})`),s}).join("")}async function ye(t=!1){console.log("üöÄ getNotionBlogPostsClient llamada - process.client:",!0,"force:",t),t&&ce();const a=M();if(!t&&le()&&a)return console.log("‚úÖ Usando datos del cache de Notion (cliente):",a.data.length,"posts"),a.data;console.log("üîÑ Obteniendo datos frescos de Notion (cliente)...");try{const s=H(),u="https://notion-proxy.adrigarcia-unahur.workers.dev",d=`/databases/${s.public.notionDatabaseId}/query`,m=await fetch(`${u}${d}`,{method:"POST",headers:{Authorization:`Bearer ${s.public.notionToken}`,"Notion-Version":"2022-06-28","Content-Type":"application/json"},body:JSON.stringify({sorts:[{property:"date",direction:"descending"}]})});if(!m.ok)throw new Error(`Error en la respuesta de Notion: ${m.status}`);const y=await m.json();console.log("üìä Respuesta de Notion (cliente) - resultados:",y.results.length);const P=[];for(const v of y.results){const k=he(v.properties),w=`/blog/${k.title?.toLowerCase().replace(/[^a-z0-9]+/g,"-")}`.replace(/-+$/,""),h=await me(v.id);P.push({id:v.id,...k,path:w,content:h})}return console.log("‚úÖ Posts procesados (cliente):",P.length),de(P),P}catch(s){console.error("‚ùå Error obteniendo posts de Notion (cliente):",s);const u=M();if(u)return console.log("üîÑ Usando cache como fallback despu√©s de error"),u.data;throw s}}export{ce as clearNotionCache,ye as getNotionBlogPostsClient,me as getNotionPageContentClient};
